{"title":"Visualização de dados, outras abordagens","markdown":{"yaml":{"title":"Visualização de dados, outras abordagens","author":"Gabriel A. D. Serafini","format":"html","editor":"visual","warming":false,"menssage":false},"headingText":"Visualização de Dados: Outras Opções para Importação e Visualização de Dados","containsRefs":false,"markdown":"\n\n\nA visualização de dados é essencial para entender e comunicar padrões e insights, existindo inúmeras possíbilidades de importação de dados. Agora iremos explorar outras técnicas e pacotes no R que facilitam a importação e visualização de datasets.\n\n## Importando Datasets\n\nUma das formas é a concatenação de dados de forma manual os atribuindo a um objeto. Para isso podemos utilizar a função nativa `c()` que concatena os dados, separados por vírgula.\n\n```{r}\ncomp <- c(\"9\", \"12.5\", \"10\", \"8\", \"13.2\", \"11\", \"10.8\", \"9.5\", \"10.8\", \"10.4\", \"13.72\", \"15.91\", \"15.7\", \"14.2\", \"15.9\", \"16.54\", \"18\", \"14.4\", \"16.41\", \"16\")\ncomp\n\ncomp <- c(9, 12.5, 10, 8, 13.2, 11, 10.8, 9.5, 10.8, 10.4, 13.72, 15.91, 15.7, 14.2, 15.9, 16.54, 18, 14.4, 16.41, 16)\ncomp\n```\n\nTambém podemos utilizar o pacote `datapasta`, que permite copiar dados de qualquer lugar e colar diretamente no R como uma tibble.\n\n```{r}\nlibrary(datapasta)\nvisitas <- tibble::tribble(\n             ~`codigo`,          ~país, ~`n2`,\n             1L,     \"Brazil\",      4303L,\n               2L,     \"Mozambique\",      43L,\n               3L,       \"Portugal\",      33L,\n               4L,  \"United States\",      23L,\n               5L,         \"Angola\",      19L,\n               6L,          \"Spain\",      16L,\n               7L,      \"(not set)\",      12L,\n               8L,       \"Colombia\",       8L,\n               9L,        \"Germany\",       5L,\n              10L,        \"Hungary\",       5L,\n              11L, \"United Kingdom\",       5L,\n              12L,    \"Netherlands\",       4L,\n              13L,        \"Ecuador\",       3L,\n              14L,         \"France\",       3L,\n              15L,          \"Chile\",       2L,\n              16L,       \"Paraguay\",       2L,\n              17L,           \"Peru\",       2L,\n              18L,      \"Argentina\",       1L,\n              19L,        \"Austria\",       1L,\n              20L,        \"Bolivia\",       1L,\n              21L,     \"Cape Verde\",       1L,\n              22L,          \"China\",       1L,\n              23L,          \"Egypt\",       1L,\n              24L,        \"Finland\",       1L,\n              25L,          \"India\",       1L,\n              26L,          \"Italy\",       1L,\n              27L,       \"Malaysia\",       1L,\n              28L,       \"Pakistan\",       1L,\n              29L,         \"Poland\",       1L,\n              30L,      \"Singapore\",       1L,\n              31L,    \"Timor-Leste\",       1L,\n              32L,        \"Uruguay\",       1L\n             )\nhead(visitas)\n```\n\n## Instalando pacotes de outros repositórios\n\nO pacote `pak` permite que os dados sejam baixados de outros repositórios. Para isso, inicialmente precisamos instalar o pacote.\n\n```{r}\n#install.packages(\"pak\")\n```\n\nAgora, poderemos instalar pacotes de outros repositórios, como o `Icens`, que será utilizado em outros tópicos. Muitos destes pacotes contem datasets que podem ser utilizados para testes de funções.\n\n```{r}\n#pak::pkg_install(\"Icens\")\n```\n\nTambém podemos baixar os pacortes diretamente do github, como o pacote do Prof. Emerson, `r4pde` através do caminho \"emdelponte/r4pde\".\n\n```{r}\n#pak::pkg_install(\"emdelponte/r4pde\")\n```\n\n## Transformando Formatos com `tidyverse`\n\nVocê pode transformar dados de formato largo para formato longo (e vice-versa) usando `tidyverse`. Para isso vamos praticar utilizando a função `tribble`, para colarmos os dados do caopítulo **10.4** do livro [**r4pde**](https://r4pde.net/temporal-fitting).\n\n```{r}\nlibrary(tidyverse)\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  ) \n```\n\n### Adiconando anotações em um gráfico\n\nNo `ggplot2`, `annotate` é uma função usada para adicionar anotações diretamente a um gráfico. Anotações podem ser texto, formas ou outras marcas visuais que ajudam a destacar ou explicar partes específicas do gráfico.\n\nA função `annotate` permite que você adicione elementos como texto, segmentos, retângulos e outros tipos de geometrias ao seu gráfico. Isso é útil para chamar a atenção para pontos específicos, adicionar rótulos personalizados ou destacar áreas de interesse.\n\nAproveitando o exemplo anterior, podemos inserir textos no gráfico fornecendo as coordenadas dos textos no mapa. Por exemplo, podemos adicionar os valores dos tratamentos para cada curva:\n\n```{r}\nlibrary(ggplot2)\npepper |> \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\") |> \n  ggplot(aes(t, inc, color = epidemic))+\n  geom_point()+\n  geom_line()+\n  annotate(geom = \"text\", x = 12, y = 0.75, label = \"1\")+\n  annotate(geom = \"text\", x = 25, y = 0.75, label = \"2\")+\n  annotate(geom = \"text\", x = 45, y = 0.75, label = \"3\")+\n  theme(legend.position = \"none\") #retirar a legenda para não ficar redundante\n```\n\n## Tabelas de Contingência com `janitor`\n\nAs tabelas de contingência permitem cruzar variáveis e observar suas interações. O pacote `janitor` facilita a criação dessas tabelas.\n\nPor exemplo a função `count` conta quantas observações existem na variável e exibe em uma tabela, podemos filtrar colocando mais variáveis.\n\n```{r}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\ncr |> \n  count(region, zone)\n  \n```\n\nPodemos cruzar as variáveis usando a função de contingência `tabyl` para cruzarmos duas variáveis, como por exemplo:\n\n```{r}\nlibrary(janitor)\ncr |> \n  tabyl(region, zone)\n```\n\n```{r}\ncr |> \n  tabyl(zone, region)\n```\n\n```{r}\ncr |> \n  tabyl(cultivar, region)\n```\n\nEsse artifício é interessante para obervações, como por exemplo, podemos observar abaixo que na cultivar melhorada só se trabalha com manejo intensivo enquanto que a cultivar local não se tem manejo, ou ele é minimo.\n\n```{r}\ncr |> \n  tabyl(cultivar, farm_management)\n```\n\n## Visualizando Dados com Gráficos\n\n### Empilhamento de Colunas\n\nPodemos empilhar colunas e visualizar a distribuição de categorias, para isso podemos utilizar o `geom_col`, como no exemplo abaixo:\n\n```{r}\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management))+\n  geom_col()\n```\n\n### Colunas Separadas\n\nPara visualizar colunas separadas, podemos utilizar `position = \"dodge2\"`, assim as colunas podem ser separadas por cultivares como nos exemplos abaixo.\n\n```{r}\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management))+\n  geom_col(position = \"dodge2\")\n```\n\n```{r}\nlibrary(ggthemes)\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management))+\n  geom_col(position = \"dodge2\")+\n  scale_fill_calc()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\n        legend.position = \"top\")+ #Tira o nome em cima\n  #geom_text(position = position_dodge(width = 0.9))+\n  facet_wrap(~cultivar, scales = \"free_x\")\n```\n","srcMarkdownNoYaml":"\n\n# Visualização de Dados: Outras Opções para Importação e Visualização de Dados\n\nA visualização de dados é essencial para entender e comunicar padrões e insights, existindo inúmeras possíbilidades de importação de dados. Agora iremos explorar outras técnicas e pacotes no R que facilitam a importação e visualização de datasets.\n\n## Importando Datasets\n\nUma das formas é a concatenação de dados de forma manual os atribuindo a um objeto. Para isso podemos utilizar a função nativa `c()` que concatena os dados, separados por vírgula.\n\n```{r}\ncomp <- c(\"9\", \"12.5\", \"10\", \"8\", \"13.2\", \"11\", \"10.8\", \"9.5\", \"10.8\", \"10.4\", \"13.72\", \"15.91\", \"15.7\", \"14.2\", \"15.9\", \"16.54\", \"18\", \"14.4\", \"16.41\", \"16\")\ncomp\n\ncomp <- c(9, 12.5, 10, 8, 13.2, 11, 10.8, 9.5, 10.8, 10.4, 13.72, 15.91, 15.7, 14.2, 15.9, 16.54, 18, 14.4, 16.41, 16)\ncomp\n```\n\nTambém podemos utilizar o pacote `datapasta`, que permite copiar dados de qualquer lugar e colar diretamente no R como uma tibble.\n\n```{r}\nlibrary(datapasta)\nvisitas <- tibble::tribble(\n             ~`codigo`,          ~país, ~`n2`,\n             1L,     \"Brazil\",      4303L,\n               2L,     \"Mozambique\",      43L,\n               3L,       \"Portugal\",      33L,\n               4L,  \"United States\",      23L,\n               5L,         \"Angola\",      19L,\n               6L,          \"Spain\",      16L,\n               7L,      \"(not set)\",      12L,\n               8L,       \"Colombia\",       8L,\n               9L,        \"Germany\",       5L,\n              10L,        \"Hungary\",       5L,\n              11L, \"United Kingdom\",       5L,\n              12L,    \"Netherlands\",       4L,\n              13L,        \"Ecuador\",       3L,\n              14L,         \"France\",       3L,\n              15L,          \"Chile\",       2L,\n              16L,       \"Paraguay\",       2L,\n              17L,           \"Peru\",       2L,\n              18L,      \"Argentina\",       1L,\n              19L,        \"Austria\",       1L,\n              20L,        \"Bolivia\",       1L,\n              21L,     \"Cape Verde\",       1L,\n              22L,          \"China\",       1L,\n              23L,          \"Egypt\",       1L,\n              24L,        \"Finland\",       1L,\n              25L,          \"India\",       1L,\n              26L,          \"Italy\",       1L,\n              27L,       \"Malaysia\",       1L,\n              28L,       \"Pakistan\",       1L,\n              29L,         \"Poland\",       1L,\n              30L,      \"Singapore\",       1L,\n              31L,    \"Timor-Leste\",       1L,\n              32L,        \"Uruguay\",       1L\n             )\nhead(visitas)\n```\n\n## Instalando pacotes de outros repositórios\n\nO pacote `pak` permite que os dados sejam baixados de outros repositórios. Para isso, inicialmente precisamos instalar o pacote.\n\n```{r}\n#install.packages(\"pak\")\n```\n\nAgora, poderemos instalar pacotes de outros repositórios, como o `Icens`, que será utilizado em outros tópicos. Muitos destes pacotes contem datasets que podem ser utilizados para testes de funções.\n\n```{r}\n#pak::pkg_install(\"Icens\")\n```\n\nTambém podemos baixar os pacortes diretamente do github, como o pacote do Prof. Emerson, `r4pde` através do caminho \"emdelponte/r4pde\".\n\n```{r}\n#pak::pkg_install(\"emdelponte/r4pde\")\n```\n\n## Transformando Formatos com `tidyverse`\n\nVocê pode transformar dados de formato largo para formato longo (e vice-versa) usando `tidyverse`. Para isso vamos praticar utilizando a função `tribble`, para colarmos os dados do caopítulo **10.4** do livro [**r4pde**](https://r4pde.net/temporal-fitting).\n\n```{r}\nlibrary(tidyverse)\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  ) \n```\n\n### Adiconando anotações em um gráfico\n\nNo `ggplot2`, `annotate` é uma função usada para adicionar anotações diretamente a um gráfico. Anotações podem ser texto, formas ou outras marcas visuais que ajudam a destacar ou explicar partes específicas do gráfico.\n\nA função `annotate` permite que você adicione elementos como texto, segmentos, retângulos e outros tipos de geometrias ao seu gráfico. Isso é útil para chamar a atenção para pontos específicos, adicionar rótulos personalizados ou destacar áreas de interesse.\n\nAproveitando o exemplo anterior, podemos inserir textos no gráfico fornecendo as coordenadas dos textos no mapa. Por exemplo, podemos adicionar os valores dos tratamentos para cada curva:\n\n```{r}\nlibrary(ggplot2)\npepper |> \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\") |> \n  ggplot(aes(t, inc, color = epidemic))+\n  geom_point()+\n  geom_line()+\n  annotate(geom = \"text\", x = 12, y = 0.75, label = \"1\")+\n  annotate(geom = \"text\", x = 25, y = 0.75, label = \"2\")+\n  annotate(geom = \"text\", x = 45, y = 0.75, label = \"3\")+\n  theme(legend.position = \"none\") #retirar a legenda para não ficar redundante\n```\n\n## Tabelas de Contingência com `janitor`\n\nAs tabelas de contingência permitem cruzar variáveis e observar suas interações. O pacote `janitor` facilita a criação dessas tabelas.\n\nPor exemplo a função `count` conta quantas observações existem na variável e exibe em uma tabela, podemos filtrar colocando mais variáveis.\n\n```{r}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\ncr |> \n  count(region, zone)\n  \n```\n\nPodemos cruzar as variáveis usando a função de contingência `tabyl` para cruzarmos duas variáveis, como por exemplo:\n\n```{r}\nlibrary(janitor)\ncr |> \n  tabyl(region, zone)\n```\n\n```{r}\ncr |> \n  tabyl(zone, region)\n```\n\n```{r}\ncr |> \n  tabyl(cultivar, region)\n```\n\nEsse artifício é interessante para obervações, como por exemplo, podemos observar abaixo que na cultivar melhorada só se trabalha com manejo intensivo enquanto que a cultivar local não se tem manejo, ou ele é minimo.\n\n```{r}\ncr |> \n  tabyl(cultivar, farm_management)\n```\n\n## Visualizando Dados com Gráficos\n\n### Empilhamento de Colunas\n\nPodemos empilhar colunas e visualizar a distribuição de categorias, para isso podemos utilizar o `geom_col`, como no exemplo abaixo:\n\n```{r}\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management))+\n  geom_col()\n```\n\n### Colunas Separadas\n\nPara visualizar colunas separadas, podemos utilizar `position = \"dodge2\"`, assim as colunas podem ser separadas por cultivares como nos exemplos abaixo.\n\n```{r}\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management))+\n  geom_col(position = \"dodge2\")\n```\n\n```{r}\nlibrary(ggthemes)\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management))+\n  geom_col(position = \"dodge2\")+\n  scale_fill_calc()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\n        legend.position = \"top\")+ #Tira o nome em cima\n  #geom_text(position = position_dodge(width = 0.9))+\n  facet_wrap(~cultivar, scales = \"free_x\")\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"aula_04.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","editor":"visual","theme":"cosmo","title":"Visualização de dados, outras abordagens","author":"Gabriel A. D. Serafini","warming":false,"menssage":false},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}