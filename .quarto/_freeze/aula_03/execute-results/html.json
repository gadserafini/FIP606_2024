{
  "hash": "ebb5195c9cbe2fa54a14b93cb6997dab",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Análise exploratória: Visualização de dados\"\nauthor: \"Gabriel A. D. Serafini\"\nformat: html\neditor: visual\nwarming: false\nmenssage: false\n---\n\n\n# Visualização de Dados\n\n## Abrindo arquivo .CSV\n\nUtilizamos o \"tidyverse\" para abrir a planilha em .CSV com o comando \"read_csv\" e o link para o arquivo.\n\nDentro do primeiro chunk colocar #\\| warming: false e #\\| menssage: false para não aparecer avisos e mensagens quando fizer o \"Render\", naquele chunk. se colocar no cabeçalho é aplicado para todos os chunks e não aparece para nenhum.\n\n\n::: {.cell warming='false' menssage='false'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 405 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (7): region, zone, district, cultivar, shade, cropping_system, farm_mana...\ndbl (6): farm, lon, lat, altitude, inc, sev2\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\nA tabela importada foi:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(cr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 13\n   farm region zone       district      lon   lat altitude cultivar shade    \n  <dbl> <chr>  <chr>      <chr>       <dbl> <dbl>    <dbl> <chr>    <chr>    \n1     1 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n2     2 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n3     3 SNNPR  Bench Maji Debub Bench  35.4  6.90     1434 Mixture  Mid shade\n4     4 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n5     5 SNNPR  Bench Maji Debub Bench  35.4  6.90     1400 Local    Sun      \n6     6 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n# ℹ 4 more variables: cropping_system <chr>, farm_management <chr>, inc <dbl>,\n#   sev2 <dbl>\n```\n\n\n:::\n:::\n\n\nPara visualizar o conjunto de dados pode-se utilizar a função \"glimpse\" que mostra os detalhes da tabela e das váriaveis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(cr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 405\nColumns: 13\n$ farm            <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…\n$ region          <chr> \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", …\n$ zone            <chr> \"Bench Maji\", \"Bench Maji\", \"Bench Maji\", \"Bench Maji\"…\n$ district        <chr> \"Debub Bench\", \"Debub Bench\", \"Debub Bench\", \"Debub Be…\n$ lon             <dbl> 35.44250, 35.44250, 35.42861, 35.42861, 35.42861, 35.3…\n$ lat             <dbl> 6.904722, 6.904722, 6.904444, 6.904444, 6.904444, 6.90…\n$ altitude        <dbl> 1100, 1342, 1434, 1100, 1400, 1342, 1432, 1100, 1400, …\n$ cultivar        <chr> \"Local\", \"Mixture\", \"Mixture\", \"Local\", \"Local\", \"Mixt…\n$ shade           <chr> \"Sun\", \"Mid shade\", \"Mid shade\", \"Sun\", \"Sun\", \"Mid sh…\n$ cropping_system <chr> \"Plantation\", \"Plantation\", \"Plantation\", \"Plantation\"…\n$ farm_management <chr> \"Unmanaged\", \"Minimal\", \"Minimal\", \"Unmanaged\", \"Unman…\n$ inc             <dbl> 86.70805, 51.34354, 43.20000, 76.70805, 47.15808, 51.3…\n$ sev2            <dbl> 55.57986, 17.90349, 8.25120, 46.10154, 12.25167, 19.91…\n```\n\n\n:::\n:::\n\n\n## Visualização de dados\n\nNo historama podemos obserar a dispersão dos dados. Além disso, podemos plotar um sumário para saber dados sobre os dados como um todo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ncr |>\n  ggplot(aes(x = inc))+\n  geom_histogram()+\n  facet_wrap(~region) #Separa por região.\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(cr$inc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   9.50   19.43   32.50   34.89   48.20   86.71 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |>\n  group_by(region) |>\n  summarize(inc_mean = mean(inc),\n            inc_med = median(inc),\n            sd_mean = sd(inc))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  region inc_mean inc_med sd_mean\n  <chr>     <dbl>   <dbl>   <dbl>\n1 Oromia     37.0    39.5    14.6\n2 SNNPR      33.4    29.6    18.9\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |>\n  group_by(cultivar) |>\n  summarize(inc_mean = mean(inc),\n            inc_med = median(inc),\n            sd_mean = sd(inc))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  cultivar inc_mean inc_med sd_mean\n  <chr>       <dbl>   <dbl>   <dbl>\n1 Improved     16.4    15.2    5.66\n2 Local        53.4    50.9   14.3 \n3 Mixture      31.9    31.6   11.2 \n```\n\n\n:::\n:::\n\n\nPodemos plotar um gráfico de distribuição, em realação a duas variáveis para poder observar melhor a relação entre elas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |>\n  ggplot(aes(inc, sev2))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nPodemos obervar melhor a simetria das variáveis, se a mediana e média forem mais próximas uma das outras a curva é simétrica, se estiverem não simétricas, podemos observar uma assimetria com cauda para a direita ou a esquerda.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ncr |>\n  ggplot(aes(x = sev2))+\n  geom_histogram()+\n  facet_wrap(~region) #Separa por região.\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(cr$sev2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.2248  2.6892  5.9490  9.0945 12.1593 55.5799 \n```\n\n\n:::\n\n```{.r .cell-code}\ncr |>\n  group_by(region) |>\n  summarize(sev_mean = mean(sev2),\n            sev_med = median(sev2),\n            sd_mean = sd(sev2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  region sev_mean sev_med sd_mean\n  <chr>     <dbl>   <dbl>   <dbl>\n1 Oromia     8.06    6.23    6.82\n2 SNNPR      9.81    4.88   10.5 \n```\n\n\n:::\n:::\n\n\nSe formos olhar por cultivar, fica mais simétrico.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ncr |>\n  ggplot(aes(x = sev2))+\n  geom_histogram()+\n  facet_wrap(~cultivar) #Separa por região.\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(cr$sev2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.2248  2.6892  5.9490  9.0945 12.1593 55.5799 \n```\n\n\n:::\n\n```{.r .cell-code}\ncr |>\n  group_by(cultivar) |>\n  summarize(sev_mean = mean(sev2),\n            sev_med = median(sev2),\n            sd_mean = sd(sev2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  cultivar sev_mean sev_med sd_mean\n  <chr>       <dbl>   <dbl>   <dbl>\n1 Improved     2.16    1.64    1.82\n2 Local       18.7    17.2    11.1 \n3 Mixture      6.47    5.43    4.35\n```\n\n\n:::\n:::\n\n\nSe quiser modificar as cores por região, colocar \"fill\" no ggplot, se colocar depois ele muda tudo.\n\nO theme_minimal tem que ver depois do scale_fill_manual pois se não irá sobrescever\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggthemes)\ncr |>\n  ggplot(aes(x = sev2, fill = region))+\n  geom_histogram(color = \"white\")+ #Color aqui é para aborda das barras do histograma.\n  facet_wrap(region ~ cultivar, ncol = 6)+ #ncol coloca o número de colunas por plot\n  #scale_fill_colorblind() #Aqui altera a plheta de cores\n  scale_fill_manual(values = c(\"red\", \"blue\"))+ #escolha manual\n  theme_minimal(base_size = 14)+ #vem depois, se não sobrescreve o scale_fill_manual, aqui também altera a fonte com base_size)\n  theme(legend.position = \"bottom\")+\n  labs(y = \"Frequency\",\n       x = \"Severity (%)\",\n       fill = \"Region\") #Alterou o nome, que estava como o da variável\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"cr1.png\", bg =\"white\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSaving 7 x 5 in image\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n:::\n\n\n## Criação de subconjunto\n\n## Seleção e Filtro\n\nPodemos selecionar as colunas com a função select() e podemos tribuir a um subconjunto (Ex.: cr2).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr2 <- cr |>\n  select(farm, region, cultivar, sev2) #select é pra colunas\n\ncr2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 405 × 4\n    farm region cultivar  sev2\n   <dbl> <chr>  <chr>    <dbl>\n 1     1 SNNPR  Local    55.6 \n 2     2 SNNPR  Mixture  17.9 \n 3     3 SNNPR  Mixture   8.25\n 4     4 SNNPR  Local    46.1 \n 5     5 SNNPR  Local    12.3 \n 6     6 SNNPR  Mixture  19.9 \n 7     7 SNNPR  Mixture  11.9 \n 8     8 SNNPR  Local    55.6 \n 9     9 SNNPR  Local    11.6 \n10    10 SNNPR  Mixture  11.4 \n# ℹ 395 more rows\n```\n\n\n:::\n:::\n\n\nPodemos também, filtrar os dados usando o filter() do pacote **dplyr** para selecionar colunas e linhas em conjunto com a função select().\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Filtra Oromia\ncr_oromia <- cr |>\n  select(farm, region, cultivar, sev2) |> #select é pra colunas\n  filter(region == \"Oromia\")\ncr_oromia\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 165 × 4\n    farm region cultivar  sev2\n   <dbl> <chr>  <chr>    <dbl>\n 1   286 Oromia Mixture   7.63\n 2   287 Oromia Mixture   9.39\n 3   288 Oromia Mixture   1.30\n 4   289 Oromia Mixture   9.79\n 5   290 Oromia Local    18.5 \n 6   291 Oromia Mixture  13.2 \n 7   292 Oromia Mixture   5.60\n 8   293 Oromia Mixture   1.06\n 9   294 Oromia Local    17.6 \n10   295 Oromia Mixture  15.4 \n# ℹ 155 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\n#Filtra SNNPR\ncr_pr <- cr |>\n  select(farm, region, cultivar, sev2) |>#select é pra colunas\n  filter(region == \"SNNPR\")\ncr_pr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 240 × 4\n    farm region cultivar  sev2\n   <dbl> <chr>  <chr>    <dbl>\n 1     1 SNNPR  Local    55.6 \n 2     2 SNNPR  Mixture  17.9 \n 3     3 SNNPR  Mixture   8.25\n 4     4 SNNPR  Local    46.1 \n 5     5 SNNPR  Local    12.3 \n 6     6 SNNPR  Mixture  19.9 \n 7     7 SNNPR  Mixture  11.9 \n 8     8 SNNPR  Local    55.6 \n 9     9 SNNPR  Local    11.6 \n10    10 SNNPR  Mixture  11.4 \n# ℹ 230 more rows\n```\n\n\n:::\n:::\n\n\n### Visualiza subconjuntos\n\nGráficos ggplot para cada subconjunto\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr_oromia |>\n  ggplot(aes(x = cultivar,\n             y = sev2))+\n  geom_boxplot()+\n  labs(title = \"Oromia\",\n       X = \"Cultivar\",\n       y = \"Severity (%)\")\n```\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncr_pr |>\n  ggplot(aes(x = cultivar,\n             y = sev2))+\n  geom_boxplot()+\n  labs(title = \"SNNPR\",\n       X = \"Cultivar\",\n       y = \"Severity (%)\")\n```\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nAgora, utilizando a biblioteca \"patchwork\" iremos plotar os dois gráficos lado a lado, sem usar o face_wrap.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- cr_oromia |>\n  ggplot(aes(x = cultivar,\n             y = sev2,\n             fill = cultivar))+\n  geom_boxplot()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")#+ #lembrar de tirar o comentário do +\n  #coord_flip() #rotaciona as coordenadas\n\np2 <- cr_pr |>\n  ggplot(aes(x = cultivar,\n             y = sev2,\n             fill = cultivar))+\n  geom_boxplot()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")#+ #lembrar de tirar o comentário do +\n  #coord_flip() #rotaciona as coordenadas\n\n#Não consegui instalar o patchwork\nlibrary(patchwork)\n\n(p1 + p2) + #pode ser + ou |, se colocar / coloca um sobre o outro. Ele funciona como equação, pode ser feito combinação dos gráficos como p1/(p2+p1)\nplot_layout(guides = \"collect\") + #Deixa somente uma legenda\nplot_annotation(tag_levels = \"A\") #diferencia maiúsculas e minúsculas\n```\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"patch.png\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSaving 7 x 5 in image\n```\n\n\n:::\n:::\n\n\nO patchwork tem várias possíbilidades interessantes, vale a pena olhar o help dele depois.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- cr_oromia |>\n  ggplot(aes(x = cultivar,\n             y = sev2,\n             fill = cultivar))+\n  geom_boxplot()+\n  theme_few() +\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")+\n  coord_flip() #rotaciona as coordenadas\n\np2 <- cr_pr |>\n  ggplot(aes(x = cultivar,\n             y = sev2,\n             fill = cultivar))+\n  geom_boxplot()+\n  theme_few() +\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")+\n  coord_flip() #rotaciona as coordenadas\n\n#Não consegui instalar o patchwork\nlibrary(patchwork)\n\n(p1 / p2) + #pode ser + ou |, se colocar / coloca um sobre o outro. Ele funciona como equação, pode ser feito combinação dos gráficos como p1/(p2+p1)\nplot_layout(guides = \"collect\",\n            axes = \"collect\")+ #Deixa somente uma legenda\nplot_annotation(title = \"Coffe rust is Ethiopia\",\n                caption = \"source: Serafini (2024)\",\n                tag_levels = \"A\") #diferencia maiúsculas e minúsculas\n```\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"patch2.png\", width = 5, height = 4)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- cr_oromia |>\n  ggplot(aes(x = cultivar,\n             y = sev2,\n             fill = cultivar))+\n  geom_boxplot()+\n  theme_few() +\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")+\n  coord_flip() #rotaciona as coordenadas\n\np3 <- cr_oromia |>\n  ggplot(aes(x = sev2))+\n  geom_histogram() +\n  labs(y = \"Freq.\",\n       x = \"Severity (%)\")\n\n#Não consegui instalar o patchwork\nlibrary(patchwork)\n\np1 + inset_element(p3, left = 0.6,\n                    bottom = 0.6,\n                    right = 1,\n                    top = 1) +\n  plot_annotation(title = \"Coffe rust is Ethiopia\",\n                caption = \"source: Serafini (2024)\",\n                tag_levels = \"A\") #diferencia maiúsculas e minúsculas\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_03_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"patch3.png\", width = 5, height = 4)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n:::\n",
    "supporting": [
      "aula_03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}