{
  "hash": "4998ed6ee87267510393ac017b795554",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 10\"\nauthor: \"Gabriel A. D. Serafini\"\nformat: html\neditor: visual\n---\n\n\n## Análise de correlação\n\nCorrelação é uma associação entre duas variáveis. Um incremento de uma variável modifica a outra.\n\nO r é sempre menor doque o R². O r é menor porque é a raiz de r. r é a força de associação entre x e y.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\ntheme_set(theme_bw())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nimgs <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimgs |> \n  pivot_longer(3:5, names_to = \"method\",\n               values_to = \"value\") |> \n  ggplot(aes(method, value))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nimgs |> \n  ggplot(aes(Assess, LeafDoctor))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\nCriando a matriz de correlação\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimgs2 <- imgs[, c(\"Assess\", \"LeafDoctor\", \"ImageJ\")]\n\nlibrary(AgroR)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'AgroR' foi compilado no R versão 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAnexando pacote: 'AgroR'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nO seguinte objeto é mascarado por 'package:dplyr':\n\n    desc\n```\n\n\n:::\n\n```{.r .cell-code}\ncorgraph(imgs2) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncor.test(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  imgs$Assess and imgs$LeafDoctor\nt = 31.119, df = 68, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n```\n\n\n:::\n\n```{.r .cell-code}\ncor(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9666367\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'corrplot' foi compilado no R versão 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\ncorrplot 0.92 loaded\n```\n\n\n:::\n\n```{.r .cell-code}\ncor_imgs2 <- cor(imgs2)\ncorrplot(cor_imgs2, method = \"number\", type = \"lower\")\n```\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\ncor_imgs2 <- cor(imgs2)\ncorrplot(cor_imgs2, method = \"circle\", type = \"lower\") #Pode ser square tabém, e escolher o type, esse pacote é muito mais customizável. diag False tira a diagonal\n```\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nOutro conjunto de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(AgroR)\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\ncampo2 <- campo |> \n  dplyr::select(DFC, FER, PROD)\n\ncorgraph(campo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nestande |> \n  ggplot(aes(trat, nplants))+\n  geom_jitter(width = 0.1, alpha = 0.5)+\n  facet_wrap(~ exp)+\n  stat_summary(fun.data = \"mean_cl_boot\", size =0.5, color = \"blue\")+\n geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nFoi pego os dados \"estande\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp2 <- estande |> \n  filter(exp == 2)\n\nexp2 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim(0,100)+\n  geom_smooth(method= \"lm\", \n              se=FALSE, \n              formula = y ~poly(x,2), color=\"black\")+\n  geom_smooth(method = \"lm\",\n              se = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# modelo linear\n\nexp2$trat2 <- exp2$trat^2 \n  \n# primeira ordem\nlm2 <- lm(nplants ~ trat, \n          data = exp2)\n# segunda ordem ou quadrático\nlm3 <- lm(nplants ~ trat + trat2 , \n          data = exp2)\n\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 194.9597\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 193.1284\n```\n\n\n:::\n:::\n\n\nQuando ajusta o modelo ele já dá as\n\nElevou ao quadrado para dar um coeficiente a mais, quanto mais coeficiente mais não linear ele fica.\n\nDois modelos, de primera ordem e de segunda ordem ou quadrado.\n\nSe explica melhor com a quadrada (0,4997) do que com a linear(0,4398) (Verificar os dados)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(AgroR)\nwith(exp2, polynomial(trat,nplants, grau = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 66.30156250 4.42096799 14.997069 1.079972e-12\ntrat        -1.77719814 0.58467380 -3.039640 6.230050e-03\nI(trat^2)    0.02222876 0.01165948  1.906496 7.036247e-02\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ         F      p-value\nLinear     1 3196.2031 3196.2031 21.823293 0.0001899378\nQuadratic  1  544.5029  544.5029  3.717801 0.0697619482\nDeviation  3  509.6690  169.8897  1.159986 0.3523240106\nResidual  18 2636.2500  146.4583                       \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndata(\"phao\")\nwith(phao, polynomial(dose,comp, grau = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n              Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 10.2097143 0.68981140 14.800733 6.427099e-13\ntrat         2.8822857 0.40856781  7.054608 4.456995e-07\nI(trat^2)   -0.3042857 0.04897332 -6.213296 2.971498e-06\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df        SSq         MSQ          F      p-value\nLinear     1  40.140800  40.1408000 14.0529338 1.265122e-03\nQuadratic  1 103.700571 103.7005714 36.3046392 6.852202e-06\nDeviation  2   1.968229   0.9841143  0.3445296 7.126767e-01\nResidual  20  57.128000   2.8564000                        \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n:::\n\n\nSensibilidade de fungicida (sensibiidade_fungicidas)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\npyra <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npyra2 <- pyra |> \n  group_by(code, state, dose) |> \n  summarise(mean_germination = mean(germination))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'code', 'state'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\npyra2 |> \n  ggplot(aes(dose, mean_germination))+\n  geom_point()+\n  geom_smooth(span = 3, se = FALSE)+\n  facet_wrap(~code)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nDose bem pequena já cai drásticamente a germinação\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(drc)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'drc' foi compilado no R versão 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCarregando pacotes exigidos: MASS\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'MASS' foi compilado no R versão 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAnexando pacote: 'MASS'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nO seguinte objeto é mascarado por 'package:dplyr':\n\n    select\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n'drc' has been loaded.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPlease cite R and 'drc' if used for a publication,\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfor references type 'citation()' and 'citation('drc')'.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAnexando pacote: 'drc'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nO seguinte objeto é mascarado por 'package:AgroR':\n\n    logistic\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOs seguintes objetos são mascarados por 'package:stats':\n\n    gaussian, getInitial\n```\n\n\n:::\n\n```{.r .cell-code}\nisolado165 <- pyra2 |> \n  filter(code == \"165\")\n\ndrc1 <- drm(mean_germination ~ dose, data = isolado165, fct = LL.3()) #pacote drc tem a função dmr\n\nAIC(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 31.55522\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#esse pacote já tem uma função que cálcula a dose letal a 50 a função ED também dá um intervalo se colocar interval = \"delta\"\n```\n:::\n\n\nPacote ec50estimator trabalha com todos os dados, ele faz de todos ao invés de fazer um por um.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ec50estimator)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'ec50estimator' foi compilado no R versão 4.4.1\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_ec50 <- estimate_EC50(mean_germination ~ dose, data = pyra2, isolate_col = \"code\", interval = \"delta\", fct = drc::LL.3())\n\ndf_ec50\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      ID strata   Estimate  Std..Error        Lower     Upper\n1    152        0.44435629 0.077789240  0.196796213 0.6919164\n2    153        0.20379664 0.042373512  0.068945217 0.3386481\n3    164        0.50775844 0.047248266  0.357393370 0.6581235\n4    165        0.55839613 0.114195113  0.194976315 0.9218159\n5    169        0.14722311 0.009555688  0.116812646 0.1776336\n6    170        0.37503889 0.043207328  0.237533889 0.5125439\n7    186        0.57975744 0.013332268  0.537328208 0.6221867\n8    187        0.21563338 0.036639446  0.099030315 0.3322365\n9    188        0.15297172 0.004284691  0.139335920 0.1666075\n10   189        0.53106193 0.023130936  0.457448972 0.6046749\n11 FGT05        0.04483862 0.019290890 -0.016553601 0.1062308\n12 FGT06        0.54497946 0.034834602  0.434120211 0.6558387\n13 FGT07        0.88770053 0.079917704  0.633366725 1.1420343\n14 FGT28        0.22608141 0.033600742  0.119148854 0.3330140\n15 FGT29        0.23601652 0.034933881  0.124841318 0.3471917\n16 FGT33        0.10481627 0.013065221  0.063236910 0.1463956\n17 FGT34        0.14773114 0.047003373 -0.001854568 0.2973169\n18 FGT35        0.20315392 0.038984604  0.079087515 0.3272203\n19 FGT42        0.45000559 0.059685890  0.260058448 0.6399527\n20 FGT43        0.49589549 0.060850771  0.302241178 0.6895498\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_ec50 |> \n  ggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = Lower, ymax = Upper))+\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](aula_10_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "aula_10_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}