---
title: "Análise exploratória: Visualização de dados"
author: "Gabriel A. D. Serafini"
format: html
editor: visual
warming: false
menssage: false
---

## Criação de subconjunto

## Seleção e Filtro

Podemos selecionar as colunas com a função select() e podemos tribuir a um subconjunto (Ex.: cr2).

```{r}
cr2 <- cr |>
  select(farm, region, cultivar, sev2) #select é pra colunas

cr2
```

Podemos também, filtrar os dados usando o filter() do pacote **dplyr** para selecionar colunas e linhas em conjunto com a função select().

```{r}
#Filtra Oromia
cr_oromia <- cr |>
  select(farm, region, cultivar, sev2) |> #select é pra colunas
  filter(region == "Oromia")
cr_oromia
#Filtra SNNPR
cr_pr <- cr |>
  select(farm, region, cultivar, sev2) |>#select é pra colunas
  filter(region == "SNNPR")
cr_pr
```

### Visualiza subconjuntos

Gráficos ggplot para cada subconjunto

```{r}
cr_oromia |>
  ggplot(aes(x = cultivar,
             y = sev2))+
  geom_boxplot()+
  labs(title = "Oromia",
       X = "Cultivar",
       y = "Severity (%)")
```

```{r}
cr_pr |>
  ggplot(aes(x = cultivar,
             y = sev2))+
  geom_boxplot()+
  labs(title = "SNNPR",
       X = "Cultivar",
       y = "Severity (%)")
```

Agora, utilizando a biblioteca "patchwork" iremos plotar os dois gráficos lado a lado, sem usar o face_wrap.

```{r}
p1 <- cr_oromia |>
  ggplot(aes(x = cultivar,
             y = sev2,
             fill = cultivar))+
  geom_boxplot()+
  labs(x = "Cultivar",
       y = "Severity (%)")#+ #lembrar de tirar o comentário do +
  #coord_flip() #rotaciona as coordenadas

p2 <- cr_pr |>
  ggplot(aes(x = cultivar,
             y = sev2,
             fill = cultivar))+
  geom_boxplot()+
  labs(x = "Cultivar",
       y = "Severity (%)")#+ #lembrar de tirar o comentário do +
  #coord_flip() #rotaciona as coordenadas

#Não consegui instalar o patchwork
library(patchwork)

(p1 + p2) + #pode ser + ou |, se colocar / coloca um sobre o outro. Ele funciona como equação, pode ser feito combinação dos gráficos como p1/(p2+p1)
plot_layout(guides = "collect") + #Deixa somente uma legenda
plot_annotation(tag_levels = "A") #diferencia maiúsculas e minúsculas

ggsave("patch.png")
```

O patchwork tem várias possíbilidades interessantes, vale a pena olhar o help dele depois.

```{r}
p1 <- cr_oromia |>
  ggplot(aes(x = cultivar,
             y = sev2,
             fill = cultivar))+
  geom_boxplot()+
  theme_few() +
  labs(x = "Cultivar",
       y = "Severity (%)")+
  coord_flip() #rotaciona as coordenadas

p2 <- cr_pr |>
  ggplot(aes(x = cultivar,
             y = sev2,
             fill = cultivar))+
  geom_boxplot()+
  theme_few() +
  labs(x = "Cultivar",
       y = "Severity (%)")+
  coord_flip() #rotaciona as coordenadas

#Não consegui instalar o patchwork
library(patchwork)

(p1 / p2) + #pode ser + ou |, se colocar / coloca um sobre o outro. Ele funciona como equação, pode ser feito combinação dos gráficos como p1/(p2+p1)
plot_layout(guides = "collect",
            axes = "collect")+ #Deixa somente uma legenda
plot_annotation(title = "Coffe rust is Ethiopia",
                caption = "source: Serafini (2024)",
                tag_levels = "A") #diferencia maiúsculas e minúsculas

ggsave("patch2.png", width = 5, height = 4)
```

```{r}
p1 <- cr_oromia |>
  ggplot(aes(x = cultivar,
             y = sev2,
             fill = cultivar))+
  geom_boxplot()+
  theme_few() +
  labs(x = "Cultivar",
       y = "Severity (%)")+
  coord_flip() #rotaciona as coordenadas

p3 <- cr_oromia |>
  ggplot(aes(x = sev2))+
  geom_histogram() +
  labs(y = "Freq.",
       x = "Severity (%)")

#Não consegui instalar o patchwork
library(patchwork)

p1 + inset_element(p3, left = 0.6,
                    bottom = 0.6,
                    right = 1,
                    top = 1) +
  plot_annotation(title = "Coffe rust is Ethiopia",
                caption = "source: Serafini (2024)",
                tag_levels = "A") #diferencia maiúsculas e minúsculas

ggsave("patch3.png", width = 5, height = 4)
```
